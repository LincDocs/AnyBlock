import{g as N,u as W,h as X,i as Z,j as ee,t as se,k as le,l as z,m as C,n as e,p as oe,q as te,s as ae,R as L,v as ce,x as re,y as de,z as ie,A as Ee,B as M,C as I,D as ne,E as ue,F as he,G as me,L as ve,H as Be,I as Ae,J as pe,K as U,M as ye,N as F}from"./app-COdqLH5H.js";const De=["/README.en.html","/README.guide.html","/","/README.show.html","/v2%20old%20docs/","/docs/api/01.%20%E4%BB%A3%E7%A0%81%E6%96%87%E6%9C%AC%E7%B1%BB.html","/docs/api/01.%20%E7%BA%AF%E6%96%87%E6%9C%AC%E7%B1%BB.html","/docs/api/02.%20%E5%88%97%E8%A1%A8%E7%B1%BB.html","/docs/api/03.%20%E4%BA%8C%E5%88%97%E5%88%97%E8%A1%A8%E7%B1%BB.html","/docs/api/04.%20%E8%A1%A8%E6%A0%BC%E7%B1%BB.html","/docs/api/05.%20%E8%A3%85%E9%A5%B0%E7%B1%BB.html","/docs/api/06.%20%E7%9B%AE%E5%BD%95%E7%B1%BB.html","/docs/api/07.%20mdit_container.html","/docs/api/08.%20%E7%89%B9%E6%AE%8A%E7%B1%BB.html","/docs/api/09.%20mermaid%E7%B1%BB.html","/docs/api/10.%20plantuml%E7%B1%BB.html","/docs/api/11.%20markmap%E7%B1%BB.html","/docs/api/Alias%E5%88%AB%E5%90%8D%E7%B3%BB%E7%BB%9F.html","/docs/api/","/docs/converter%20docs/Deco.html","/docs/converter%20docs/Fold%E7%89%B9%E6%AE%8A%E7%94%A8%E6%B3%95.html","/docs/converter%20docs/Mindmaps.html","/docs/converter%20docs/Tow-Layer-Tree.html","/docs/dev%20docs/01.%20%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E6%A0%B7%E5%BC%8F.html","/docs/dev%20docs/02.%20%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E6%AD%A3%E5%88%99.html","/docs/dev%20docs/03.%20%E7%AE%80%E5%8C%96%E4%B8%BAmini%E7%89%88%E6%9C%AC.html","/docs/dev%20docs/04.%20%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%B0%E7%9A%84%E5%A4%84%E7%90%86%E5%99%A8.html","/docs/dev%20docs/Support%20Me.html","/docs/dev%20docs/%E5%BC%80%E5%8F%91%E9%9A%8F%E7%AC%94.html","/docs/en/01.%20Introduce.html","/docs/en/02.%20Processor.html","/docs/en/03.%20Selector.html","/docs/en/04.%20InstallAndUse_Obsidian.html","/docs/en/04.%20InstallAndUse_VuePress.html","/docs/en/06.%20Separator%20declaration.html","/docs/faq/Markdown%E5%90%88%E5%B9%B6%E8%A1%A8%E6%A0%BC.html","/docs/faq/","/docs/zh/01.%20%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D.html","/docs/zh/02.%20%E5%A4%84%E7%90%86%E5%99%A8.html","/docs/zh/03.%20%E9%80%89%E6%8B%A9%E5%99%A8.html","/docs/zh/04.%20%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8_Obsidian%E7%89%88.html","/docs/zh/04.%20%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8_VuePress%E7%89%88.html","/docs/zh/05.%20%E7%B2%BE%E5%BD%A9%E7%94%A8%E4%BE%8B.html","/docs/zh/06.%20%E5%88%86%E9%9A%94%E7%AC%A6%E8%AF%B4%E6%98%8E.html","/docs/zh/%E5%8C%BA%E5%88%86%E6%AF%94%E8%BE%83%E5%A4%9A%E7%A7%8D%E5%88%97%E8%A1%A8%E8%BD%AC%E8%A1%A8%E6%A0%BC.html","/docs/zh/%E6%A0%87%E9%A2%98%E5%A4%84%E7%90%86%E5%99%A8.html","/v2%20old%20docs/docs/en/0.%20Basic%20Course.html","/v2%20old%20docs/docs/en/1.%20Use%20example%20-%20ListSelector.html","/v2%20old%20docs/docs/en/2.%20Use%20example%20-%20QuoteSelector%20and%20CodeSelector.html","/v2%20old%20docs/docs/en/3.%20Use%20example%20-%20GlobalSelector.html","/v2%20old%20docs/docs/en/4.%20Use%20example%20-%20More%20Processor.html","/v2%20old%20docs/docs/en/5.%20Plug-in%20design%20concept.html","/v2%20old%20docs/docs/en/9.%20For%20Developer.html","/v2%20old%20docs/docs/en/9.%20TODO.html","/v2%20old%20docs/docs/en/","/v2%20old%20docs/docs/zh/0.%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B.html","/v2%20old%20docs/docs/zh/1.%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%20-%20%E5%88%97%E8%A1%A8%E9%80%89%E6%8B%A9%E5%99%A8.html","/v2%20old%20docs/docs/zh/2.%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%20-%20%E4%BB%A3%E7%A0%81%E5%9D%97%E5%BC%95%E7%94%A8%E5%9D%97%E9%80%89%E6%8B%A9%E5%99%A8.html","/v2%20old%20docs/docs/zh/3.%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%20-%20%E5%85%A8%E5%B1%80%E9%80%89%E6%8B%A9%E5%99%A8.html","/v2%20old%20docs/docs/zh/4.%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%20-%20%E6%9B%B4%E5%A4%9A%E5%A4%84%E7%90%86%E5%99%A8.html","/v2%20old%20docs/docs/zh/5.%20%E6%8F%92%E4%BB%B6%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5.html","/v2%20old%20docs/docs/zh/9.%20For%20Developer.html","/v2%20old%20docs/docs/zh/9.%20TODO.html","/v2%20old%20docs/docs/zh/","/404.html","/docs/","/docs/converter%20docs/","/docs/dev%20docs/","/docs/en/","/docs/zh/","/v2%20old%20docs/docs/","/category/","/tag/","/Blog/","/star/","/timeline/"],ge="SLIMSEARCH_QUERY_HISTORY",A=U(ge,[]),Ce=()=>{const{queryHistoryCount:t}=F;return{enabled:t>0,queryHistories:A,addQueryHistory:d=>{A.value=Array.from(new Set([d,...A.value.slice(0,t-1)]))},removeQueryHistory:d=>{A.value=[...A.value.slice(0,d),...A.value.slice(d+1)]}}},b=t=>De[t.id]+("anchor"in t?`#${t.anchor}`:""),Fe="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:T}=F,p=U(Fe,[]),fe=()=>({enabled:T>0,resultHistories:p,addResultHistory:r=>{{const d={link:b(r),display:r.display};"header"in r&&(d.header=r.header),p.value=[d,...p.value.slice(0,T-1)]}},removeResultHistory:r=>{p.value=[...p.value.slice(0,r),...p.value.slice(r+1)]}}),He=t=>{const{page:r,routeLocale:d}=ne(),f=ue(),a=z(0),y=C(()=>a.value>0),n=he([]);return me(()=>{const{search:H,terminate:m}=ve(),D=Ae(v=>{const{resultsFilter:S=o=>o,querySplitter:B,suggestionsFilter:w,...c}=f.value;v?(a.value+=1,H(v,d.value,c).then(o=>S(o,v,d.value,r.value)).then(o=>{a.value-=1,n.value=o}).catch(o=>{console.warn(o),a.value-=1,a.value||(n.value=[])})):n.value=[]},F.searchDelay-F.suggestDelay,{maxWait:5e3});Be([t,d],([v])=>D(v.join(" "))),pe(()=>{m()})}),{isSearching:y,results:n}};var xe=N({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(t,{emit:r}){const d=W(),f=X(),a=Z(ee),{addQueryHistory:y,queryHistories:n,removeQueryHistory:H}=Ce(),{resultHistories:m,addResultHistory:D,removeResultHistory:v}=fe(),S=se(t,"queries"),{results:B,isSearching:w}=He(S),c=le({isQuery:!0,index:0}),o=z(0),u=z(0),Q=C(()=>n.value.length>0||m.value.length>0),x=C(()=>B.value.length>0),k=C(()=>B.value[o.value]||null),O=()=>{const{isQuery:s,index:l}=c;l===0?(c.isQuery=!s,c.index=s?m.value.length-1:n.value.length-1):c.index=l-1},_=()=>{const{isQuery:s,index:l}=c;l===(s?n.value.length-1:m.value.length-1)?(c.isQuery=!s,c.index=0):c.index=l+1},$=()=>{o.value=o.value>0?o.value-1:B.value.length-1,u.value=k.value.contents.length-1},P=()=>{o.value=o.value<B.value.length-1?o.value+1:0,u.value=0},j=()=>{u.value<k.value.contents.length-1?u.value+=1:P()},V=()=>{u.value>0?u.value-=1:$()},R=s=>s.map(l=>ye(l)?l:e(l[0],l[1])),Y=s=>{if(s.type==="customField"){const l=ie[s.index]||"$content",[h,i=""]=Ee(l)?l[f.value].split("$content"):l.split("$content");return s.display.map(E=>e("div",R([h,...E,i])))}return s.display.map(l=>e("div",R(l)))},g=()=>{o.value=0,u.value=0,r("updateQuery",""),r("close")},G=()=>e("div",{class:"slimsearch-records"},e("div",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},a.value.queryHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},n.value.map((s,l)=>{const h=c.isQuery&&c.index===l;return e("li",{class:["slimsearch-record-matches",{active:h}],role:"option","aria-selected":h,onClick:()=>{r("updateQuery",s)}},e("div",[e(M,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},s),e("button",{type:"button",class:"slimsearch-remove-icon",title:a.value.remove,"aria-label":a.value.remove,innerHTML:I,onClick:i=>{i.preventDefault(),i.stopPropagation(),H(l)}})]))}))])),J=()=>e("ul",{class:"slimsearch-records"},e("li",{class:"slimsearch-record"},[e("div",{class:"slimsearch-record-title"},a.value.resultHistory),e("ul",{class:"slimsearch-record-contents",role:"listbox"},m.value.map((s,l)=>{const h=!c.isQuery&&c.index===l;return e("li",{class:["slimsearch-record-matches",{active:h}],role:"option","aria-selected":h},e(L,{to:s.link,onClick:()=>{g()}},()=>[e(M,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[s.header?e("div",{class:"slimsearch-record-content-header"},s.header):null,e("div",s.display.map(i=>R(i)).flat())]),e("button",{type:"button",class:"slimsearch-remove-icon",title:a.value.remove,"aria-label":a.value.remove,innerHTML:I,onClick:i=>{i.preventDefault(),i.stopPropagation(),v(l)}})]))}))]));return oe("keydown",s=>{if(t.isFocusing){if(x.value){if(s.key==="ArrowUp")V();else if(s.key==="ArrowDown")j();else if(s.key==="Enter"){const l=k.value.contents[u.value];y(t.queries.join(" ")),D(l),d.push(b(l)),g()}}else if(s.key==="ArrowUp")O();else if(s.key==="ArrowDown")_();else if(s.key==="Enter"){const{index:l}=c;c.isQuery?(s.preventDefault(),r("updateQuery",n.value[l])):(d.push(m.value[l].link),g())}}}),te([o,u],()=>{var s;(s=document.querySelector(".slimsearch-record.active .slimsearch-record-matches.active"))==null||s.scrollIntoView(!1)},{flush:"post"}),()=>e("div",{id:"slimsearch-results",class:["slimsearch-result-wrapper",{empty:t.queries.length?!x.value:!Q.value}]},t.queries.length?w.value?e(ae,{hint:a.value.searching}):x.value?e("div",{class:"slimsearch-records",role:"listbox","aria-labeledby":"slimsearch-label"},B.value.map(({title:s,contents:l},h)=>{const i=o.value===h;return e("div",{class:["slimsearch-record",{active:i}],role:"group","aria-selected":i},[e("div",{class:"slimsearch-record-title"},s||a.value.defaultTitle),e("ul",{class:"slimsearch-record-contents"},l.map((E,K)=>{const q=i&&u.value===K;return e("li",{class:["slimsearch-record-matches",{active:q}],role:"option","aria-selected":q},e(L,{to:b(E),onClick:()=>{y(t.queries.join(" ")),D(E),g()}},()=>[E.type==="text"?null:e(E.type==="title"?ce:E.type==="heading"?re:de,{class:"slimsearch-record-type"}),e("div",{class:"slimsearch-record-content"},[E.type==="text"&&E.header?e("div",{class:"slimsearch-record-content-header"},E.header):null,e("div",Y(E))])]))}))])})):a.value.emptyResult:Q.value?[G(),J()]:a.value.emptyHistory)}});export{xe as default};
