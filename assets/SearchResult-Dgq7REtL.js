import{l as N,u as X,m as M,n as Z,y as ee,t as se,p as le,q as k,v as C,x as l,z as te,w as ae,A as oe,R as T,B as ce,D as ie,E as re,F as de,G as ue,H as I,J as U,K as Ee,L as ne,M as he,N as me,O as ve,Q as Be,S as Ae,T as pe,U as O,V as ye,W as F}from"./app-Ag2tXgZl.js";const ge=["/README.github.html","/","/README.show.html","/v2%20old%20docs/","/docs/api/01.%20%E7%BA%AF%E6%96%87%E6%9C%AC%E7%B1%BB.html","/docs/api/02.%20%E5%88%97%E8%A1%A8%E7%B1%BB.html","/docs/api/03.%20%E4%BA%8C%E5%88%97%E5%88%97%E8%A1%A8%E7%B1%BB.html","/docs/api/04.%20%E8%A1%A8%E6%A0%BC%E7%B1%BB.html","/docs/api/05.%20%E8%A3%85%E9%A5%B0%E7%B1%BB.html","/docs/api/06.%20%E7%9B%AE%E5%BD%95%E7%B1%BB.html","/docs/api/07.%20mdit_container.html","/docs/api/08.%20%E7%89%B9%E6%AE%8A%E7%B1%BB.html","/docs/api/09.%20mermaid%E7%B1%BB.html","/docs/api/10.%20plantuml%E7%B1%BB.html","/docs/api/11.%20markmap%E7%B1%BB.html","/docs/api/Alias%E5%88%AB%E5%90%8D%E7%B3%BB%E7%BB%9F.html","/docs/api/","/docs/converter%20docs/Fold%E7%89%B9%E6%AE%8A%E7%94%A8%E6%B3%95.html","/docs/converter%20docs/Mindmaps.html","/docs/converter%20docs/Tow-Layer-Tree.html","/docs/dev%20docs/01.%20%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E6%A0%B7%E5%BC%8F.html","/docs/dev%20docs/02.%20%E5%A6%82%E4%BD%95%E4%BF%AE%E6%94%B9%E6%AD%A3%E5%88%99.html","/docs/dev%20docs/03.%20%E7%AE%80%E5%8C%96%E4%B8%BAmini%E7%89%88%E6%9C%AC.html","/docs/dev%20docs/04.%20%E5%A6%82%E4%BD%95%E8%87%AA%E5%AE%9A%E4%B9%89%E6%96%B0%E7%9A%84%E5%A4%84%E7%90%86%E5%99%A8.html","/docs/dev%20docs/Support%20Me.html","/docs/dev%20docs/%E5%BC%80%E5%8F%91%E9%9A%8F%E7%AC%94.html","/docs/en/01.%20Introduce.html","/docs/en/02.%20Processor.html","/docs/en/03.%20Selector.html","/docs/en/04.%20InstallAndUse_Obsidian.html","/docs/en/04.%20InstallAndUse_VuePress.html","/docs/en/06.%20Separator%20declaration.html","/docs/zh/01.%20%E7%AE%80%E5%8D%95%E4%BB%8B%E7%BB%8D.html","/docs/zh/02.%20%E5%A4%84%E7%90%86%E5%99%A8.html","/docs/zh/03.%20%E9%80%89%E6%8B%A9%E5%99%A8.html","/docs/zh/04.%20%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8_Obsidian%E7%89%88.html","/docs/zh/04.%20%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8_VuePress%E7%89%88.html","/docs/zh/05.%20%E7%B2%BE%E5%BD%A9%E7%94%A8%E4%BE%8B.html","/docs/zh/06.%20%E5%88%86%E9%9A%94%E7%AC%A6%E8%AF%B4%E6%98%8E.html","/docs/zh/%E5%8C%BA%E5%88%86%E6%AF%94%E8%BE%83%E5%A4%9A%E7%A7%8D%E5%88%97%E8%A1%A8%E8%BD%AC%E8%A1%A8%E6%A0%BC.html","/docs/zh/%E6%A0%87%E9%A2%98%E5%A4%84%E7%90%86%E5%99%A8.html","/v2%20old%20docs/docs/en/0.%20Basic%20Course.html","/v2%20old%20docs/docs/en/1.%20Use%20example%20-%20ListSelector.html","/v2%20old%20docs/docs/en/2.%20Use%20example%20-%20QuoteSelector%20and%20CodeSelector.html","/v2%20old%20docs/docs/en/3.%20Use%20example%20-%20GlobalSelector.html","/v2%20old%20docs/docs/en/4.%20Use%20example%20-%20More%20Processor.html","/v2%20old%20docs/docs/en/5.%20Plug-in%20design%20concept.html","/v2%20old%20docs/docs/en/9.%20For%20Developer.html","/v2%20old%20docs/docs/en/9.%20TODO.html","/v2%20old%20docs/docs/en/","/v2%20old%20docs/docs/zh/0.%20%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B.html","/v2%20old%20docs/docs/zh/1.%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%20-%20%E5%88%97%E8%A1%A8%E9%80%89%E6%8B%A9%E5%99%A8.html","/v2%20old%20docs/docs/zh/2.%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%20-%20%E4%BB%A3%E7%A0%81%E5%9D%97%E5%BC%95%E7%94%A8%E5%9D%97%E9%80%89%E6%8B%A9%E5%99%A8.html","/v2%20old%20docs/docs/zh/3.%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%20-%20%E5%85%A8%E5%B1%80%E9%80%89%E6%8B%A9%E5%99%A8.html","/v2%20old%20docs/docs/zh/4.%20%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B%20-%20%E6%9B%B4%E5%A4%9A%E5%A4%84%E7%90%86%E5%99%A8.html","/v2%20old%20docs/docs/zh/5.%20%E6%8F%92%E4%BB%B6%E8%AE%BE%E8%AE%A1%E7%90%86%E5%BF%B5.html","/v2%20old%20docs/docs/zh/9.%20For%20Developer.html","/v2%20old%20docs/docs/zh/9.%20TODO.html","/v2%20old%20docs/docs/zh/","/404.html","/docs/","/docs/converter%20docs/","/docs/dev%20docs/","/docs/en/","/docs/zh/","/v2%20old%20docs/docs/","/category/","/tag/","/Blog/","/star/","/timeline/"],De="SLIMSEARCH_QUERY_HISTORY",B=O(De,[]),Ce=()=>{const{queryHistoryCount:a}=F;return{enabled:a>0,queryHistories:B,addQueryHistory:i=>{B.value=Array.from(new Set([i,...B.value.slice(0,a-1)]))},removeQueryHistory:i=>{B.value=[...B.value.slice(0,i),...B.value.slice(i+1)]}}},w=a=>ge[a.id]+("anchor"in a?`#${a.anchor}`:""),Fe="SLIMSEARCH_RESULT_HISTORY",{resultHistoryCount:b}=F,A=O(Fe,[]),fe=()=>({enabled:b>0,resultHistories:A,addResultHistory:c=>{{const i={link:w(c),display:c.display};"header"in c&&(i.header=c.header),A.value=[i,...A.value.slice(0,b-1)]}},removeResultHistory:c=>{A.value=[...A.value.slice(0,c),...A.value.slice(c+1)]}}),He=a=>{const c=Ee(),i=M(),f=ne(),r=k(0),p=C(()=>r.value>0),E=he([]);return me(()=>{const{search:H,terminate:h}=ve(),y=Ae(m=>{const{resultsFilter:S=t=>t,querySplitter:v,suggestionsFilter:Q,...o}=c.value;m?(r.value+=1,H(m,i.value,o).then(t=>S(t,m,i.value,f.value)).then(t=>{r.value-=1,E.value=t}).catch(t=>{console.warn(t),r.value-=1,r.value||(E.value=[])})):E.value=[]},F.searchDelay-F.suggestDelay,{maxWait:5e3});Be([a,i],([m])=>y(m.join(" "))),pe(()=>{h()})}),{isSearching:p,results:E}};var Re=N({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(a,{emit:c}){const i=X(),f=M(),r=Z(ee),{addQueryHistory:p,queryHistories:E,removeQueryHistory:H}=Ce(),{resultHistories:h,addResultHistory:y,removeResultHistory:m}=fe(),S=se(a,"queries"),{results:v,isSearching:Q}=He(S),o=le({isQuery:!0,index:0}),t=k(0),n=k(0),q=C(()=>E.value.length>0||h.value.length>0),R=C(()=>v.value.length>0),x=C(()=>v.value[t.value]||null),P=()=>{const{isQuery:e,index:s}=o;s===0?(o.isQuery=!e,o.index=e?h.value.length-1:E.value.length-1):o.index=s-1},_=()=>{const{isQuery:e,index:s}=o;s===(e?E.value.length-1:h.value.length-1)?(o.isQuery=!e,o.index=0):o.index=s+1},$=()=>{t.value=t.value>0?t.value-1:v.value.length-1,n.value=x.value.contents.length-1},j=()=>{t.value=t.value<v.value.length-1?t.value+1:0,n.value=0},V=()=>{n.value<x.value.contents.length-1?n.value+=1:j()},Y=()=>{n.value>0?n.value-=1:$()},z=e=>e.map(s=>ye(s)?s:l(s[0],s[1])),G=e=>{if(e.type==="customField"){const s=de[e.index]||"$content",[d,D=""]=ue(s)?s[f.value].split("$content"):s.split("$content");return e.display.map(u=>l("div",z([d,...u,D])))}return e.display.map(s=>l("div",z(s)))},g=()=>{t.value=0,n.value=0,c("updateQuery",""),c("close")},W=()=>l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},r.value.queryHistory),E.value.map((e,s)=>l("div",{class:["slimsearch-result-item",{active:o.isQuery&&o.index===s}],onClick:()=>{c("updateQuery",e)}},[l(I,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},e),l("button",{class:"slimsearch-remove-icon",innerHTML:U,onClick:d=>{d.preventDefault(),d.stopPropagation(),H(s)}})]))])),J=()=>l("ul",{class:"slimsearch-result-list"},l("li",{class:"slimsearch-result-list-item"},[l("div",{class:"slimsearch-result-title"},r.value.resultHistory),h.value.map((e,s)=>l(T,{to:e.link,class:["slimsearch-result-item",{active:!o.isQuery&&o.index===s}],onClick:()=>{g()}},()=>[l(I,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[e.header?l("div",{class:"content-header"},e.header):null,l("div",e.display.map(d=>z(d)).flat())]),l("button",{class:"slimsearch-remove-icon",innerHTML:U,onClick:d=>{d.preventDefault(),d.stopPropagation(),m(s)}})]))]));return te("keydown",e=>{if(a.isFocusing){if(R.value){if(e.key==="ArrowUp")Y();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const s=x.value.contents[n.value];p(a.queries.join(" ")),y(s),i.push(w(s)),g()}}else if(e.key==="ArrowUp")P();else if(e.key==="ArrowDown")_();else if(e.key==="Enter"){const{index:s}=o;o.isQuery?(c("updateQuery",E.value[s]),e.preventDefault()):(i.push(h.value[s].link),g())}}}),ae([t,n],()=>{var e;(e=document.querySelector(".slimsearch-result-list-item.active .slimsearch-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>l("div",{class:["slimsearch-result-wrapper",{empty:a.queries.length?!R.value:!q.value}],id:"slimsearch-results"},a.queries.length?Q.value?l(oe,{hint:r.value.searching}):R.value?l("ul",{class:"slimsearch-result-list"},v.value.map(({title:e,contents:s},d)=>{const D=t.value===d;return l("li",{class:["slimsearch-result-list-item",{active:D}]},[l("div",{class:"slimsearch-result-title"},e||r.value.defaultTitle),s.map((u,K)=>{const L=D&&n.value===K;return l(T,{to:w(u),class:["slimsearch-result-item",{active:L,"aria-selected":L}],onClick:()=>{p(a.queries.join(" ")),y(u),g()}},()=>[u.type==="text"?null:l(u.type==="title"?ce:u.type==="heading"?ie:re,{class:"slimsearch-result-type"}),l("div",{class:"slimsearch-result-content"},[u.type==="text"&&u.header?l("div",{class:"content-header"},u.header):null,l("div",G(u))])])})])})):r.value.emptyResult:q.value?[W(),J()]:r.value.emptyHistory)}});export{Re as default};
